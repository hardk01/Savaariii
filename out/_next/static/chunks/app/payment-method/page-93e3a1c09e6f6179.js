(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[691],{9852:(e,n,a)=>{Promise.resolve().then(a.bind(a,6773))},6046:(e,n,a)=>{"use strict";var t=a(6658);a.o(t,"useRouter")&&a.d(n,{useRouter:function(){return t.useRouter}})},6773:(e,n,a)=>{"use strict";a.r(n),a.d(n,{default:()=>i});var t=a(5155),o=a(1359),r=a(6046),s=a(2115);let l=e=>{let{userCarData:n}=e,a=(0,r.useRouter)(),[o,l]=(0,s.useState)(""),[i,c]=(0,s.useState)(),[d,p]=(0,s.useState)(0),[m,u]=(0,s.useState)(""),[h,x]=(0,s.useState)(null),[g,y]=(0,s.useState)(null);(0,s.useEffect)(()=>{n&&(x(n.price),y(n.price))},[n]);let b=e=>{p(e),u(""),null!==h&&y(e/100*h)},f=async()=>{try{let e=await fetch("".concat("http://192.168.1.8:3000/","v1/coupons/").concat(o));if(!e.ok)throw Error("Invalid coupon code");let a=await e.json();console.log(a.data,"data from coupon code");let t=a.data.discount;if(n&&null!==t){let e=n.price*t/100,a=n.price-e;x(a),y(d/100*a),u("")}}catch(e){u("Invalid coupon code. Please try again."),n&&(x(n.price),y(n.price*(d/100)))}},j=()=>new Promise(e=>{let n=document.createElement("script");n.src="https://checkout.razorpay.com/v1/checkout.js",n.onload=()=>e(!0),n.onerror=()=>e(!1),document.body.appendChild(n)}),v=async e=>{let a=localStorage.getItem("token"),t={initialPrice:n.price,discountedPrice:h,finalPayableAmount:g,couponCode:o,selectedDiscount:d,paymentMethod:e,id:i},r=localStorage.getItem("bookingId");if(!r){alert("Booking ID is missing. Cannot proceed.");return}let s=[...JSON.parse(localStorage.getItem("paymentData")||"[]"),t];localStorage.setItem("payment",JSON.stringify(t)),localStorage.setItem("paymentData",JSON.stringify(s)),await fetch("".concat("http://192.168.1.8:3000/","v1/cab-bookings/").concat(r),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({totalAmount:g,paymentMethod:e})})},N=async()=>{let e=0===d?"cod":"online";if("cod"===e){await v(e),a.push("/payment-details");return}if(!await j()){alert("Failed to load Razorpay SDK. Please try again.");return}let n=new window.Razorpay({key:"rzp_test_eyCE8DA3agdWdo",amount:Math.round(100*g),currency:"INR",name:"Car Payment",description:"Partial or Full Payment",handler:async function(n){alert("Payment successful! Razorpay ID: ".concat(n.razorpay_payment_id)),c(n.razorpay_payment_id),await v(e),a.push("/payment")},prefill:{name:"John Doe",email:"john.doe@example.com",contact:"9999999999"},notes:{address:"Razorpay Corporate Office"},theme:{color:"#3399cc"}});n.on("payment.failed",function(e){alert("Payment failed! Reason: ".concat(e.error.description))}),n.open()};return(0,t.jsx)("section",{className:"box-cta-7 background-body py-96",children:(0,t.jsxs)("div",{className:"container position-relative z-1",children:[(0,t.jsx)("div",{className:"bg-shape"}),(0,t.jsx)("div",{className:"row position-relative z-1",children:(0,t.jsx)("div",{className:"col-lg-6 p-md-5 p-4",children:(0,t.jsxs)("div",{className:"background-card p-md-5 p-4 rounded-3 my-3",children:[(0,t.jsx)("h5",{className:"neutral-1000 mb-2",children:"Payment"}),(0,t.jsx)("p",{className:"text-sm-medium neutral-500 mb-25",children:"Estimate your monthly auto loan payments with this calculator."}),(0,t.jsx)("div",{className:"form-contact",children:(0,t.jsxs)("div",{className:"row",children:[(0,t.jsxs)("div",{className:"row pt-3 pb-4",children:[(0,t.jsxs)("div",{className:"col-md-5 col-8 d-flex flex-column gap-1",children:[(0,t.jsx)("p",{className:"text-sm-bold neutral-1000",children:"Initial Price :"}),(0,t.jsx)("p",{className:"text-sm-bold neutral-1000",children:"Discounted Price :"}),(0,t.jsx)("p",{className:"text-sm-bold neutral-1000",children:"Payable Amount :"})]}),(0,t.jsxs)("div",{className:"col-md-7 col-4 d-flex flex-column gap-1 align-items-end align-items-md-start",children:[(0,t.jsxs)("p",{className:"text-sm-bold neutral-1000",children:["₹",null==n?void 0:n.price]}),(0,t.jsxs)("p",{className:"text-sm-bold neutral-1000",children:["₹",h]}),(0,t.jsxs)("p",{className:"text-sm-bold text-primary-dark",children:["₹",g]})]})]}),(0,t.jsx)("div",{className:"col-lg-12",children:(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{className:"text-sm-medium neutral-1000",children:"Apply Coupon"}),(0,t.jsxs)("div",{style:{position:"relative",display:"inline-block",width:"100%"},children:[(0,t.jsx)("input",{value:o,onChange:e=>l(e.target.value),className:"form-control",type:"text",placeholder:"Enter Coupon Code",style:{paddingRight:"2rem"}}),(0,t.jsx)("svg",{onClick:f,width:17,height:16,viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",color:"#666",cursor:"pointer"},children:(0,t.jsx)("path",{d:"M8.5 15L15.5 8L8.5 1M15.5 8L1.5 8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})]})]})}),(0,t.jsx)("div",{className:"col-lg-12",children:(0,t.jsxs)("div",{className:"pricing-options",children:[["0","25","50","100"].map((e,n)=>(0,t.jsxs)("label",{className:"plan-card ".concat(d===Number(e)?"active":""),onClick:()=>b(Number(e)),children:[(0,t.jsx)("input",{type:"radio",name:"plan",value:e,checked:d===Number(e),onChange:()=>b(Number(e))}),(0,t.jsx)("div",{className:"plan-content",children:(0,t.jsxs)("div",{className:"plan-price",children:[(0,t.jsxs)("strong",{children:[e,"%"]})," ",(0,t.jsx)("span",{children:"Pay"})]})})]},n)),(0,t.jsx)("style",{children:'\n          .pricing-options {\n            display: flex;\n            gap: 1rem;\n            padding: 1.5rem;\n            border-radius: 10px;\n            justify-content: center;\n          }\n\n          .plan-card {\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 10px;\n            padding: 1rem 1.5rem;\n            display: flex;\n            align-items: center;\n            cursor: pointer;\n            transition: box-shadow 0.3s ease, border-color 0.3s ease;\n            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);\n            position: relative;\n          }\n\n          .plan-card:hover {\n            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n          }\n\n          .plan-card input[type="radio"] {\n            appearance: none;\n            -webkit-appearance: none;\n            height: 16px;\n            width: 16px;\n            border: 2px solid #ccc;\n            border-radius: 50%;\n            position: absolute;\n            top: 12px;\n            right: 12px;\n            cursor: pointer;\n            transition: all 0.3s ease;\n          }\n\n          .plan-card input[type="radio"]:checked {\n            border-color: #28a745;\n            background-color: #28a745;\n          }\n\n          .plan-card.active {\n            border-color: #28a745;\n            box-shadow: 0 0 0 2px rgba(40, 167, 69, 0.2);\n          }\n\n          .plan-content {\n            text-align: left;\n          }\n\n          .plan-title {\n            font-weight: bold;\n            margin-bottom: 0.25rem;\n            font-size: 0.9rem;\n            letter-spacing: 0.5px;\n          }\n\n          .plan-price {\n            font-size: 1rem;\n            color: #333;\n          }\n\n          .plan-price strong {\n            font-size: 1.2rem;\n          }\n\n          .plan-price span {\n            color: #888;\n            font-size: 0.9rem;\n          }'})]})}),(0,t.jsx)("div",{className:"col-lg-12",children:(0,t.jsxs)("button",{onClick:N,className:"btn btn-book",children:[0===d?"Pay on Delivery":"Proceed to Payment",(0,t.jsx)("svg",{width:17,height:16,viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M8.5 15L15.5 8L8.5 1M15.5 8L1.5 8",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})]})})]})})]})})})]})})},i=()=>{let[e,n]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=localStorage.getItem("selectedCarsInfo");e&&n(JSON.parse(e))},[]),(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(o.default,{children:(0,t.jsx)(l,{userCarData:e})})})}}},e=>{var n=n=>e(e.s=n);e.O(0,[855,503,99,359,441,517,358],()=>n(9852)),_N_E=e.O()}]);